; Generated by Tempo v1.0.0 Compiler
; Source: examples/stack_protection_v2.tempo
; Total WCET: 1 cycles
; Max function WCET: 1 cycles
; Trusted functions: 0

section .text
section .data
    ; Global data section

section .text
global _start


; Function: STACK_CANARY (WCET: 1 cycles, Security: 0)
STACK_CANARY:
    push ebp
    mov ebp, esp
    sub esp, 64    ; Local variable space
    mov eax, 3735928559
    mov esp, ebp
    pop ebp
    ret
    mov esp, ebp
    pop ebp
    ret

; Function: ssp_init (WCET: 1 cycles, Security: 0)
ssp_init:
    push ebp
    mov ebp, esp
    sub esp, 64    ; Local variable space
    mov eax, 1
    mov esp, ebp
    pop ebp
    ret
    mov esp, ebp
    pop ebp
    ret

; Function: ssp_check_stack (WCET: 1 cycles, Security: 0)
ssp_check_stack:
    push ebp
    mov ebp, esp
    sub esp, 64    ; Local variable space
    ; Load variable base
    mov eax, [ebp+8]
    push eax
    mov eax, 4194304
    pop ebx
    cmp ebx, eax
    setl al
    movzx eax, al
    test eax, eax
    jz .L0x60000348c540_else
    mov eax, 0
    mov esp, ebp
    pop ebp
    ret
    jmp .L0x60000348c540_end
.L0x60000348c540_else:
.L0x60000348c540_end:
    ; Load variable base
    mov eax, [ebp+8]
    push eax
    mov eax, 6291456
    pop ebx
    cmp ebx, eax
    setg al
    movzx eax, al
    test eax, eax
    jz .L0x60000348c850_else
    mov eax, 0
    mov esp, ebp
    pop ebp
    ret
    jmp .L0x60000348c850_end
.L0x60000348c850_else:
.L0x60000348c850_end:
    mov eax, 1
    mov esp, ebp
    pop ebp
    ret
    mov esp, ebp
    pop ebp
    ret

; Function: ssp_protect_function (WCET: 1 cycles, Security: 0)
ssp_protect_function:
    push ebp
    mov ebp, esp
    sub esp, 64    ; Local variable space
    ; Load variable stack_ptr
    mov eax, [ebp+8]
    push eax
    call ssp_check_stack
    add esp, 4
    push eax
    mov eax, 0
    pop ebx
    cmp ebx, eax
    sete al
    movzx eax, al
    test eax, eax
    jz .L0x60000348cd90_else
    mov eax, 0
    mov esp, ebp
    pop ebp
    ret
    jmp .L0x60000348cd90_end
.L0x60000348cd90_else:
.L0x60000348cd90_end:
    ; Load variable stack_ptr
    mov eax, [ebp+8]
    push eax
    mov eax, 4
    pop ebx
    sub ebx, eax
    mov eax, ebx
    mov esp, ebp
    pop ebp
    ret
    mov esp, ebp
    pop ebp
    ret

; Function: ssp_verify_function (WCET: 1 cycles, Security: 0)
ssp_verify_function:
    push ebp
    mov ebp, esp
    sub esp, 64    ; Local variable space
    ; Load variable canary_addr
    mov eax, [ebp+8]
    push eax
    call ssp_check_stack
    add esp, 4
    push eax
    mov eax, 0
    pop ebx
    cmp ebx, eax
    sete al
    movzx eax, al
    test eax, eax
    jz .L0x60000348d420_else
    mov eax, 0
    mov esp, ebp
    pop ebp
    ret
    jmp .L0x60000348d420_end
.L0x60000348d420_else:
.L0x60000348d420_end:
    mov eax, 1
    mov esp, ebp
    pop ebp
    ret
    mov esp, ebp
    pop ebp
    ret

; Function: ssp_panic (WCET: 1 cycles, Security: 0)
ssp_panic:
    push ebp
    mov ebp, esp
    sub esp, 64    ; Local variable space
    mov eax, 3735936685
    mov esp, ebp
    pop ebp
    ret
    mov esp, ebp
    pop ebp
    ret
